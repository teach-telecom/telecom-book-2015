## USER DATAGRAM PROTOCOL (UDP)/TRANSMISSION CONTROL PROTOCOL (TCP)

#### USER DATAGRAM PROTOCOL (UDP)
UDP позволяет приложениям отправлять инкапсулированные IP-дейтаграммы без установления соединений. UDP описан в RFC 768.
С помощью протокола UDP передаются сегменты, состоящие из 8-байтного заголовка, за которым следует поле полезной нагрузки. Два номера портов служат для идентификации конечных точек внутри отправляющей и принимающей машин. Когда прибывает пакет UDP, содержимое его поля полезной нагрузки передается процессу, связанному с портом назначения. В сущности, весь смысл использования UDP вместо обычного IP заключается как раз в указании портов источника и приемника. Без этих двух полей на транспортном уровне невозможно было бы определить действие, которое следует произвести с пакетом. В соответствии с полями портов производится корректная доставка сегментов.
Информация о порте источника требуется прежде всего при создании ответа, пересылаемого отправителю. Копируя значения поля Порт источника из входящего сегмента в поле Порт назначения исходящего сегмента, процесс, посылающий ответ, может указать, какому именно процессу на противоположной стороне он предназначается.
Поле Длина UDP содержит информацию о длине сегмента, включая заголовок и полезную нагрузку. Контрольная сумма UDP не является обязательной. Если она не подсчитывается, ее значение равно 0 (настоящая нулевая контрольная сумма кодируется всеми единицами).

##### таблица Udp протокол
![таблица Udp протокол](http://www.tutorialsweb.com/networking/tcp-ip/images/fig8_UDP.jpg)

Отключать функцию подсчета контрольной суммы глупо, за исключением одного случая — когда нужна высокая производительность (например, при передаче оцифрованной речи).

Наверное, стоит прямо сказать о том, чего UDP не делает. Итак, UDP не занимается контролем потока, контролем ошибок, повторной передачей после приема испорченного сегмента. Все это перекладывается на пользовательские процессы. Что же он делает? UDP предоставляет интерфейс для IP путем демультиплексирования нескольких процессов, использующих порты. Это все, что он делает. Для процессов, которым хочется управлять потоком, контролировать ошибки и временные интервалы, протокол UDP — это как раз то, что доктор прописал.

Одной из областей, где UDP применяется особенно широко, является область клиент-серверных приложений. Зачастую клиент посылает короткий запрос серверу и надеется получить короткий ответ. Если запрос или ответ теряется, клиент по прошествии определенного временного интервала может попытаться еще раз. Это позволяет не только упростить код, но и уменьшить требуемое количество собщений по сравнению с протоколами, которым требуется начальная настройка.

DNS (Domain Name System — служба имен доменов) — это приложение, которое использует UDP именно так, как описано выше. В двух словах, если программе нужно найти IP-адрес по имени хоста, например, www.vanderboot.ru, она может послать UDP-пакет с этим именем на сервер DNS. Сервер в ответ на запрос посылает UDP-пакет с IP-адресом хоста. Никакой предварительной настройки не требуется, как не требуется и разрыва соединения после завершения задачи. По сети просто передаются два сообщения.

#### Некоторые зарезирвированные порты
* 20 FTP-DATA File Transfer [Default Data]
* 21 FTP File Transfer [Control]
* 23 TELNET Telnet
* 25 SMTP Simple Mail Transfer
* 37 TIME Time
* 69 TFTP Trivial File Transfer
* 79 FINGER Finger
* 110 POP3 Post Office Protocol v 3
* 123 NTP Network Time Protocol
* 143 IMAP2 Interim Mail Access Prot. v2
* 163 SNMP Simple Network Man. Prot.

#### недостатки udp протокол 
* Приложения использующие модель запрос-ответ" также можно нарушить. При запросе клиент будет получать пакеты ICMP Destination Unreachable. И есть вероятность что все клиенты смогут адекватно отреагировать на этот поток ложной информации. 
* UDP Storm - необходимо что бы на сервере было открыто как минимум два порта. Например отправляешь на один из открытых портов UDP запрос, а в качестве отправителя указываешь адрес второго открытого UDP порта и тут происходит самое интересное - порты отвечают друг другу бесконечно. В результате данной атаки снижается производительность сервера.
* Системы телефонной связи через Internet организуют соединения" на уровне инкапсулируемых в дейтаграммы UDP данных (например, телефонное" соединение между абонентами). Для таких приложений поток информации о недоступности удаленной стороны может приводить к разрыву соединения на уровне инкапсулированного в UDP протокола.
* UDP Package - смысл атаки заключается в отправке некорректного пакета на сервис UDP. Например UDP пакет с некорректными полями служебных данных. 
* Для некоторых приложений может играть важную роль целостность сессии . Здесь можно поэкспериментировать. 
UDP DoS - тип атаки "отказ в обслуживании" не обошол стороной и UDP, для реализации данного вида атак необходимо сгенерировать большое количество UDP-пакетов направленных на определенную машину. В результате успешной атаки происходит либо зависание либо его перезагрузка. Осуществить атаку можно из за того что в UDP отсутствует механизм предотвращения перегрузок. 

### TRANSMISSION CONTROL PROTOCOL (TCP)
UDP является простым протоколом и имеет определенную область применения. В первую очередь, это клиент-серверные взаимодействия и мультимедиа. Тем не менее, большинству интернет-приложений требуется надежная, последователь­ная передача. UDP не удовлетворяет этим требованиям, поэтому требуется иной протокол. Такой протокол называется TCP, и он является рабочей лошадкой Интернета.
###### Основы TCP
Протокол TCP (Transmission Control Protocol — протокол управления передачей) был специально разработан для обеспечения надежного сквозного байтового потока по ненадежной интерсети. Объединенная сеть отличается от отдельной сети тем, что ее различные участки могут обладать сильно различающейся топологией, пропускной способностью, значениями времени задержки, размерами пакетов и другими параметрами. При разработке TCP основное внимание уделялось способности протокола адаптироваться к свойствам объединенной сети и отказоустойчивости при возникновении различных проблем.

Протокол TCP описан в RFC 793. Со временем были обнаружены различные ошибки и неточности, и по некоторым пунктам требования были изменены. Подробное описание этих уточнений и исправлений дается в RFC 1122. Расширения протокола приведены в RFC 1323.

Каждая машина, поддерживающая протокол TCP, обладает транспортной сущностью TCP, являющейся либо библиотечной процедурой, либо пользовательским процессом, либо частью ядра системы. В любом случае, транспортная сущность управляет TCP-потоками и интерфейсом с IP-уровнем. TCP-сущность принимает от локальных процессов пользовательские потоки данных, разбивает их на куски, не превосходящие 64 Кбайт (на практике это число обычно равно 460 байтам данных, что позволяет поместить их в один кадр Ethernet с заголов­ками IP и TCP), и посылает их в виде отдельных IP-дейтаграмм. Когда IP-дейтаграммы с TCP-данными прибывают на машину, они передаются TCP-сущности, которая восстанавливает исходный байтовый поток. Для простоты мы иногда будем употреблять «TCP» для обозначения транспортной сущности TCP (части программного обеспечения) или протокола TCP (набора правил). Из контекста будет понятно, что имеется в виду. Например, в выражении «Пользователь передает данные TCP» подразумевается, естественно, транспортная сущность TCP.

Уровень IP не гарантирует правильной доставки дейтаграмм, поэтому именно TCP приходится следить за истекшими интервалами ожидания и в случае необходимости заниматься повторной передачей пакетов. Бывает, что дейтаграммы прибывают в неправильном порядке. Восстанавливать сообщения из таких дейтаграмм обязан также TCP. Таким образом, протокол TCP призван обеспечить надежность, о которой мечтают многие пользователи и которая не предоставляется протоколом IP.
##### таблица Tcp протокол
![таблица Tcp протокол](http://home.mira.net/~marcop/graphics/data_unit.gif)
##### схема Tcp протокол 
![tcp flow chat](https://upload.wikimedia.org/wikipedia/en/9/9e/TCP_operation.gif)
